{"version":3,"sources":["../lib/runtime.js"],"names":["global","_tryCallback","func","ex","setResult","error","name","message","stack","_execute","eval","_code","dispatchSync","args","parameters","JSON","stringify","result","_dispatchSync","apply","parse","value","Error","dispatchAsync","callback","wrappedCallback","push","_dispatchAsync","httpRequest","options","_httpRequest","response","_setResult","setTimeout","timeout","handler","_setTimeout","clearTimeout","id","_clearTimeout","console","log","_log","_error"],"mappings":"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","file":"runtime.js","sourcesContent":["global._tryCallback = (func) => {\n  try {\n    func();\n  } catch (ex) {\n    global.setResult({\n      error: {\n        name: ex.name,\n        message: ex.message,\n        stack: ex.stack\n      }\n    });\n  }\n};\n\nglobal._execute = () => {\n  global._tryCallback(() => {\n    eval(global._code);\n  });\n};\n\nglobal.dispatchSync = (name, args) => {\n  const parameters = [ JSON.stringify([ name, ...(args || []) ]) ];\n\n  const result = global._dispatchSync.apply(global, parameters);\n\n  if (result == null) {\n    return null;\n  }\n\n  const [error, value] = JSON.parse(result);\n\n  if (error) {\n    throw new Error(error.message);\n  }\n\n  return value;\n}\n\nglobal.dispatchAsync = (name, args, callback) => {\n  if (typeof callback !== 'function') {\n    callback = () => {};\n  }\n\n  const parameters = [ JSON.stringify([ name, ...(args || []) ]) ];\n\n  const wrappedCallback = (args) => {\n    global._tryCallback(() => {\n      callback.apply(null, JSON.parse(args));\n    });\n  };\n\n  parameters.push(wrappedCallback);\n\n  const result = global._dispatchAsync.apply(global, parameters);\n\n  return result != null ? JSON.parse(result) : null;\n}\n\nglobal.httpRequest = (options, callback) => {\n  const parameters = [ JSON.stringify([ options ]) ];\n\n  if (callback) {\n    const wrappedCallback = (args) => {\n      global._tryCallback(() => {\n        callback.apply(null, JSON.parse(args));\n      });\n    };\n\n    parameters.push(wrappedCallback);\n  }\n\n  const result = global._httpRequest.apply(global, parameters);\n\n  if (result == null) {\n    return null;\n  }\n\n  const [error, response] = JSON.parse(result);\n\n  if (!callback && error) {\n    throw new Error(error.message);\n  }\n\n  return response;\n};\n\nglobal.setResult = (result) => {\n  return global._setResult(result != null ? JSON.stringify(result) : null);\n};\n\nglobal.setTimeout = (callback, timeout) => {\n  const handler = () => {\n    global._tryCallback(callback);\n  };\n\n  return global._setTimeout(handler, timeout);\n};\n\nglobal.clearTimeout = (id) => {\n  return global._clearTimeout(id);\n};\n\nglobal.console = {\n  log: (...args) => {\n    global._log(JSON.stringify(args));\n  },\n  error: (...args) => {\n    global._error(JSON.stringify(args));\n  }\n};\n\nglobal._execute();\n"]}